# 勤務表Webアプリケーション

## 概要

このプロジェクトは、従業員の日々の勤務状況を記録し、月次の作業報告書として管理・印刷するためのWebアプリケーションです。バックエンドはPython (Flask)、フロントエンドはJavaScript (React) で構築されています。

## 主な機能

- **作業報告書**: ExcelライクなUIで、出退勤時刻、休憩、作業内容を直感的に入力できます。
- **自動計算**: 勤務時間を入力すると、実働時間が自動で計算・表示されます。
- **日報**: 日々の詳細な業務内容や課題、翌日の予定などを記録し、月ごとに一覧で確認できます。
- **マスターメンテナンス**: 管理者権限を持つユーザー（オーナー）が、社員情報を追加・更新できます。
- **印刷**: 作成した作業報告書を、A4用紙に最適化されたレイアウトで印刷できます。

## 技術スタック

| 領域 | 技術 | 目的 |
| :--- | :--- | :--- |
| **バックエンド** | Python 3, Flask | APIサーバーの構築、ビジネスロジック |
| **データベース** | SQLite3 | データ永続化 |
| **フロントエンド** | React 18, Vite | UIの構築、ユーザー体験の提供 |
| **スタイリング** | Tailwind CSS | モダンで効率的なCSSスタイリング |
| **HTTPクライアント**| axios | フロントエンドとバックエンド間の非同期通信 |
| **その他** | react-modal, react-to-print | モーダルウィンドウ、印刷機能 |

## プロジェクト構成

```
.
├── back_end/
│   ├── app.py                  # Flaskメインアプリ、APIエンドポイント
│   ├── attendance_calculator.py  # 勤怠時間計算ロジック
│   ├── init_db.py              # DB初期化スクリプト
│   ├── schema.sql              # DBスキーマ定義
│   ├── requirements.txt        # Python依存パッケージ
│   └── num.id                  # ★オーナー社員ID設定ファイル
│
└── front_end/
    ├── src/
    │   ├── App.jsx             # Reactアプリケーションのルートコンポーネント
    │   └── components/         # Reactコンポーネント群
    ├── vite.config.js          # Vite設定ファイル (APIプロキシ含む)
    └── package.json            # npm依存パッケージ
```

## 開発環境のセットアップ

### 前提条件

- Python 3.8 以降
- Node.js 18.0 以降
- `pip` 及び `npm`

### 手順

1.  **リポジトリのクローン**:
    ```sh
    git clone <repository-url> && cd <repository-directory>
    ```

2.  **バックエンドのセットアップ**:
    ```sh
    # 依存Pythonパッケージをインストール
    pip install -r back_end/requirements.txt

    # データベースを初期化（注意：既存のデータはすべて消去されます）
    python back_end/init_db.py
    ```

3.  **フロントエンドのセットアップ**:
    ```sh
    cd front_end
    npm install
    cd ..
    ```

## アプリケーションの起動

開発環境でアプリを起動するには、バックエンドとフロントエンドのサーバーを両方実行する必要があります。ターミナルを2つ開き、それぞれで以下のコマンドを実行してください。

- **ターミナル 1 (バックエンド)**:
  ```sh
  python back_end/app.py
  ```
  *バックエンドサーバーが `http://localhost:5000` で起動します。*

- **ターミナル 2 (フロントエンド)**:
  ```sh
  cd front_end
  npm run dev
  ```
  *フロントエンド開発サーバーが `http://localhost:5173` で起動します。*

起動後、Webブラウザで `http://localhost:5173` にアクセスしてください。

## オーナーシップと認証

このアプリケーションには「オーナー」という概念があります。

- **オーナー**: アプリケーションの管理者です。作業報告書の承認や、マスターメンテナンスでの社員情報の編集権限を持ちます。
- **設定方法**: オーナーは `back_end/num.id` ファイルに記載された社員IDのユーザーです。データベース初期化直後は、社員ID `1` の「システム 管理者」がオーナーとして設定されています。
- **認証**: マスターメンテナンス画面でオーナーとして認証（ログイン）すると、データの編集が可能になります。初期パスワードは `123` です。

## 本番環境へのデプロイ

### 1. フロントエンドのビルド

Reactアプリケーションを最適化された静的ファイルに変換します。

```sh
cd front_end && npm run build && cd ..
```
これにより、`front_end/dist` ディレクトリに本番用ファイルが生成されます。

### 2. 本番用サーバーの起動

`waitress` (WSGIサーバー) を使用してFlaskアプリケーションを起動します。

```sh
waitress-serve --host 0.0.0.0 --port 5000 back_end.app:app
```
`--host 0.0.0.0` は、サーバー機のIPアドレスに対するすべてのリクエストを受け付ける設定です。

### 3. アプリケーションへのアクセス

サーバーを起動後、同じネットワーク上のPCから `http://<サーバーのIPアドレス>:5000` にアクセスします。
