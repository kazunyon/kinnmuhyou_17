# 勤務表アプリケーション

## 1. プロジェクト概要

このプロジェクトは、従業員が月次の作業報告書をWeb上で作成・提出するためのフルスタック・アプリケーションです。バックエンドはPythonとFlask、フロントエンドはReact（Vite環境）で構築されており、SQLiteデータベースを使用してデータを永続化します。

主な目的は、直感的なUI（Excelライクなグリッド）を提供し、日々の勤務時間の記録、管理、そして印刷を容易にすることです。

## 2. アーキテクチャ概要

- **フロントエンド**:
  - `React`と`Vite`で構築されたシングルページアプリケーション（SPA）。
  - `Tailwind CSS`によるスタイリング。
  - `axios`を使用してバックエンドAPIと非同期通信。
  - 状態管理は主に`useState`と`useEffect`フックを利用。

- **バックエンド**:
  - `Flask`を使用した軽量なWebフレームワーク。
  - `SQLite3`によるリレーショナルデータベース。
  - RESTful APIを提供し、フロントエンドからのリクエストに応じてCRUD操作を実行。
  - 本番環境では`waitress` WSGIサーバーで動作。

- **通信**:
  - 開発環境: Viteの開発サーバーが`/api`へのリクエストをFlaskサーバー（ポート5000）にプロキシします。
  - 本番環境: Flaskがフロントエンドの静的ファイル（`front_end/dist`）を配信し、APIも同じオリジンから提供します。

## 3. 主な機能

- **作業報告書入力**: カレンダー形式の表で、出社・退社時刻、休憩時間を入力すると、勤務時間と実働時間が自動計算されます。
- **日報入力**: 各日付の詳細な業務内容、問題点、課題、翌日の予定などを記録できます。
- **マスターメンテナンス**: オーナー権限を持つユーザーが社員情報の追加・更新を行えます。
- **印刷機能**: 現在表示している作業報告書を、A4用紙に最適化されたレイアウトで印刷できます。
- **Excelエクスポート**: 作業報告書をExcelファイル（`.xlsx`）としてダウンロードできます。（`excelUtils.js`に実装）

## 4. 使用技術

- **バックエンド**: Python 3, Flask, SQLite3
- **フロントエンド**: React 18, Vite, Tailwind CSS 3.4.3
- **ライブラリ**: axios, react-modal, ExcelJS, jpholidayなど

## 5. 開発環境のセットアップ

アプリケーションをローカル環境で起動するための手順です。

### 前提条件
- Python (3.8以降)
- Node.js (18.0以降)

### 手順

1.  **バックエンドの準備**:
    ```bash
    # 必要なPythonライブラリをインストール
    pip install -r back_end/requirements.txt

    # データベースを初期化（注意：既存のデータはすべて削除されます）
    python back_end/init_db.py
    ```

2.  **フロントエンドの準備**:
    ```bash
    # front_endディレクトリに移動
    cd front_end

    # 必要なnpmパッケージをインストール
    npm install

    # プロジェクトルートに戻る
    cd ..
    ```

3.  **アプリケーションの起動**:
    ターミナルを2つ開き、それぞれで以下のコマンドを実行します。

    - **ターミナル1 (バックエンド)**:
      ```bash
      python back_end/app.py
      ```

    - **ターミナル2 (フロントエンド)**:
      ```bash
      cd front_end
      npm run dev
      ```

4.  **ブラウザでアクセス**:
    `http://localhost:5173` にアクセスするとアプリケーションが表示されます。

## 6. 本番環境へのデプロイ

1.  **フロントエンドのビルド**:
    ```bash
    cd front_end
    npm run build
    cd ..
    ```
    これにより、`front_end/dist`ディレクトリに静的ファイルが生成されます。

2.  **本番用サーバーの起動**:
    `waitress`を使用してWSGIサーバーを起動します。
    ```bash
    waitress-serve --host 0.0.0.0 --port 5000 back_end.app:app
    ```

3.  **ブラウザでアクセス**:
    `http://<サーバーのIPアドレス>:5000` にアクセスします。

## 7. プロジェクト構成

### `back_end/`
| ファイル名 | 役割 |
| :--- | :--- |
| `app.py` | Flaskアプリケーション本体（APIエンドポイント定義） |
| `attendance_calculator.py` | 勤怠時間計算ロジック |
| `init_db.py` | データベース初期化スクリプト |
| `schema.sql` | データベーススキーマ定義 |
| `requirements.txt` | Python依存パッケージリスト |
| `num.id` | オーナーの社員IDを格納するファイル |

### `front_end/`
| パス | 役割 |
| :--- | :--- |
| `src/App.jsx` | アプリケーションのルートコンポーネント、状態管理 |
| `src/components/` | 各UIパーツのReactコンポーネント群 |
| `src/utils/` | ユーティリティ関数群（日付、時間計算など） |
| `vite.config.js` | Vite設定ファイル（プロキシ設定など）|
| `package.json` | npmパッケージ定義 |

---
*このドキュメントは、アプリケーションの理解とメンテナンスを容易にするために自動生成・更新されました。*
