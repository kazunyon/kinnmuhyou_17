# 勤務表アプリケーション

## 1. プロジェクト概要

このプロジェクトは、従業員が月次の作業報告書をWeb上で作成・提出するための勤務表アプリケーションです。
バックエンドはPythonとFlask、フロントエンドはReact, Vite, Tailwind CSSを使用して構築されています。
Excelのような直感的な操作で、日々の勤務時間を記録し、管理することができます。

## 2. 主な機能

### 【画面】作業報告書入力
- カレンダー形式の表で月間の勤務状況を管理します。
- 「出社時刻」「退社時刻」「休憩時間」を入力すると、「勤務時間」と「作業時間」が自動で計算されます。
- 年月のプルダウンで、表示する月を簡単に切り替えられます。
- 土曜日は薄い青色、日曜日・祝日は薄い赤色で表示され、休日が視覚的に分かります。
- 入力内容は「保存」ボタンでデータベースに保存されます。

### 【画面】日報入力
- 作業報告書の特定の日付をダブルクリックすると、詳細な日報入力画面が表示されます。
- 「作業内容」に加えて、「問題点」「課題」「明日する内容」「所感」などを記録できます。

### 【画面】マスターメンテナンス
- 従業員の「会社名」「部署名」「氏名」などの基本情報を設定します。

### 印刷機能
- 表示されている作業報告書を、ブラウザの印刷機能を使ってA4用紙1枚に収まるレイアウトで印刷できます。

## 3. 使用技術

本プロジェクトで使用されている主な技術は以下の通りです。

- **バックエンド**:
  - Python 3
  - Flask (Webフレームワーク)
  - SQLite3 (データベース)
- **フロントエンド**:
  - React 18 (UIライブラリ)
  - Vite (ビルドツール)
  - Tailwind CSS 3.4.3 (CSSフレームワーク)
- **その他**:
  - jpholiday (日本の祝日データ取得ライブラリ)

## 4. 前提条件

このアプリケーションをあなたのPCで動かすには、以下のソフトウェアがインストールされている必要があります。

- Python (バージョン3.8以上)
- Node.js (バージョン18.0以上)

## 5. インストールと実行手順

この手順は、PCに不慣れな方でも分かるように、一つ一つのステップを丁寧に説明しています。
ターミナル（Windowsでは「コマンドプロンプト」や「PowerShell」）を開いて、以下のコマンドを順番に実行してください。

### ステップ1: バックエンド（サーバー側）の準備

まず、アプリケーションの頭脳となるバックエンドを準備します。

1.  **必要なライブラリをインストールする**
    以下のコマンドを実行して、バックエンドで必要なPythonライブラリをインストールします。
    `requirements.txt`というファイルに書かれたリストを元に、必要なものが自動でインストールされます。

    ```bash
    pip install -r back_end/requirements.txt
    ```

2.  **データベースを初期化する**
    次に、データを保存するためのデータベースを作成します。
    **このコマンドは非常に重要です。** `init_db.py` という設計図を元に、新しいデータベースファイル (`database.db`) を作成します。

    ```bash
    python back_end/init_db.py
    ```

    成功すると、「データベースの初期化が完了しました。」というメッセージが表示されます。

    > **【注意！】** このコマンドを実行すると、**もし既にデータが存在していても、全て消去されてまっさらな状態に戻ります。**
    > アプリケーションを一番最初にセットアップする時、またはデータを全てリセットしたい特別な場合にのみ実行してください。

### ステップ2: フロントエンド（画面側）の準備

次に、ブラウザに表示される画面の部分を準備します。

1.  **`front_end` ディレクトリに移動する**
    まず、フロントエンド関連のファイルが置かれている `front_end` フォルダに移動します。

    ```bash
    cd front_end
    ```

2.  **必要なライブラリをインストールする**
    次に、画面表示に必要なライブラリをインストールします。`package.json` というファイルに書かれたリストを元に、こちらも自動でインストールされます。

    ```bash
    npm install
    ```

3.  **元のディレクトリに戻る**
    インストールが終わったら、元の場所に戻っておきます。

    ```bash
    cd ..
    ```

### ステップ3: アプリケーションの実行（開発環境）

開発中は、バックエンドとフロントエンドを別々に動かすことで、コードの変更がすぐに反映されるなど、効率的に作業を進めることができます。
**ターミナルを2つ開いて**、それぞれで以下のコマンドを実行してください。

1.  **【1つ目のターミナル】バックエンドサーバーを起動する**
    以下のコマンドで、バックエンドのプログラム（APIサーバー）を起動します。

    ```bash
    python back_end/app.py
    ```

    このターミナルは、サーバーを動かし続けるために、**開いたままにしておいてください。**

2.  **【2つ目のターミナル】フロントエンドサーバーを起動する**
    以下のコマンドで、フロントエンドの開発サーバーを起動します。

    ```bash
    cd front_end
    npm run dev
    ```

3.  **ブラウザで確認する**
    ターミナルに `Local:` という文字に続いて `http://localhost:5173` のようなアドレスが表示されたら成功です。
    お使いのWebブラウザ（Google Chromeなど）を開き、そのアドレスにアクセスしてください。勤務表アプリケーションが表示されます。

## 6. ファイル構成

このプロジェクトの主要なファイルと、その役割は以下の通りです。

### バックエンド (`back_end`)
サーバー側の処理を担当するファイル群です。

| 物理ファイル名     | 論理ファイル名（役割）       |
| ------------------ | ---------------------------- |
| `app.py`           | Flaskアプリケーション本体      |
| `init_db.py`       | データベース初期化スクリプト |
| `schema.sql`       | データベーススキーマ定義     |
| `requirements.txt` | Python依存パッケージリスト   |

### フロントエンド (`front_end`)
ブラウザに表示される画面の処理を担当するファイル群です。

| 物理ファイル名                      | 論理ファイル名（役割）                     |
| ----------------------------------- | ------------------------------------------ |
| `src/main.jsx`                      | Reactアプリケーションのエントリーポイント  |
| `src/App.jsx`                       | Reactアプリケーション本体                  |
| `src/components/ReportScreen.jsx`   | 作業報告書メイン画面コンポーネント         |
| `src/components/ReportTable.jsx`    | 作業報告書テーブルコンポーネント           |
| `src/components/DailyReportModal.jsx` | 日報入力モーダルコンポーネント             |
| `src/components/MasterModal.jsx`    | マスターメンテナンスモーダルコンポーネント |
| `src/components/PrintLayout.jsx`    | 印刷用レイアウトコンポーネント             |

### 設定ファイル等

| 物理ファイル名        | 論理ファイル名（役割）             |
| --------------------- | ---------------------------------- |
| `index.html`          | アプリケーションの土台となるHTML   |
| `package.json`        | フロントエンド パッケージ定義      |
| `vite.config.js`      | Vite 設定ファイル                  |
| `tailwind.config.js`  | Tailwind CSS 設定ファイル          |
| `postcss.config.js`   | PostCSS 設定ファイル               |
| `src/index.css`       | グローバルCSS（フォント設定等）    |

## 7. デプロイ方法（製品版の公開手順）

このアプリケーションを、開発中のテスト環境ではなく、実際に多くの方にご利用いただくための「本番環境」で動作させるための手順をご案内します。

この方法では、まずフロントエンド（画面側）のプログラムを、Webサーバーがそのまま公開できる静的なファイル（HTML/CSS/JavaScript）の形式に変換（**ビルド**）します。その後、変換されたフロントエンドのファイル一式を、バックエンド（サーバー側）のFlaskアプリケーションから直接配信します。
これにより、通常は2つ必要になるサーバープロセスを1つに統合でき、シンプルで安定した運用が可能になります。

### ステップ1: フロントエンドのビルド（公開用ファイルの作成）

はじめに、Reactで書かれたソースコードを、Webブラウザが直接解釈できるファイル形式に変換する「ビルド」という作業を行います。

1.  **フロントエンドの作業フォルダに移動します**
    まず、ターミナルで `front_end` という名前のフォルダに移動します。`cd` は「Change Directory」の略で、作業場所を移動するためのコマンドです。

    ```bash
    cd front_end
    ```

2.  **ビルドコマンドを実行します**
    以下のコマンドを実行すると、本番公開用に最適化されたファイルが自動的に作成されます。
    処理が完了すると、`front_end` フォルダの中に `dist` という新しいフォルダが作られ、その中に必要なファイルがすべて格納されます。

    ```bash
    npm run build
    ```

3.  **元の場所に戻ります**
    ビルド作業が終わりましたので、`cd ..` コマンドで一つ上の階層（元のプロジェクトルート）に戻ります。

    ```bash
    cd ..
    ```

### ステップ2: 本番用サーバーの起動

次に、完成したアプリケーションを公開するためのWebサーバーを起動します。
開発時は手軽なサーバーを使いましたが、本番環境ではより安定性とパフォーマンスに優れた `waitress` という **WSGIサーバー** を利用します。

> **WSGIサーバーとは？**
> Pythonで書かれたWebアプリケーション（今回はFlask）を、本格的なWebサーバーとして動作させるための中継役を担うソフトウェアです。

1.  **必要なライブラリを再度確認します**
    「5. インストールと実行手順」の `pip install -r back_end/requirements.txt` が正常に完了していれば、`waitress` も既にインストールされていますので、追加の作業は不要です。

2.  **本番サーバーを起動します**
    以下のコマンドを実行すると、`waitress` サーバーが起動し、私たちのアプリケーションが本番モードで動き始めます。

    ```bash
    waitress-serve --host 0.0.0.0 --port 5000 back_end.app:app
    ```
    *   `--host 0.0.0.0` という指定により、お使いのPCだけでなく、同じネットワークに接続されている他のPCやスマートフォンからもアクセスできるようになります。
    *   `--port 5000` は、ポート番号5000番で通信を待ち受ける設定です。
    *   `back_end.app:app` は、`back_end` フォルダの中にある `app.py` ファイルの中の `app` という名前のFlaskアプリケーションを起動してください、という指示です。

3.  **ブラウザでアクセスして確認します**
    お使いのWebブラウザを起動し、アドレスバーに `http://<サーバーのIPアドレス>:5000` と入力してアクセスしてください。
    ご自身のPCで確認する場合は、 `http://127.0.0.1:5000` もしくは `http://localhost:5000` となります。

    開発時とは異なり、フロントエンドとバックエンドが一つに統合されているため、このアドレスだけでアプリケーションの全ての機能が動作します。